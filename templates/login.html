{% extends "base.html" %}
{% block title %}Login{% endblock %}
{% block content %}
<div class="row justify-content-center mt-4">
  <div class="col-md-5">
    <div class="card shadow-sm">
      <div class="card-header bg-primary text-white">
        <i class="fa-solid fa-right-to-bracket me-1"></i> Entrar
      </div>
      <div class="card-body">

        {# Mensagens flash (caso o base.html não já renderize) #}
        {% with messages = get_flashed_messages(with_categories=True) %}
          {% if messages %}
            {% for category, message in messages %}
              <div class="alert alert-{{ 'danger' if category == 'error' else category }} alert-dismissible fade show" role="alert">
                {{ message }}
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
              </div>
            {% endfor %}
          {% endif %}
        {% endwith %}

        <form method="post" action="{{ url_for('auth.login') }}" novalidate>
          {# suporte a redirect pós-login #}
          {% if request.args.get('next') %}
            <input type="hidden" name="next" value="{{ request.args.get('next') }}">
          {% endif %}

          <div class="mb-3">
            <label class="form-label">E-mail</label>
            <div class="input-group">
              <span class="input-group-text"><i class="fa-solid fa-envelope"></i></span>
              <input type="email" name="email" class="form-control" placeholder="email@exemplo.com" required autofocus>
            </div>
          </div>

          <div class="mb-3">
            <label class="form-label">Senha</label>
            <div class="input-group">
              <span class="input-group-text"><i class="fa-solid fa-lock"></i></span>
              <input type="password" name="senha" class="form-control" placeholder="Sua senha" required>
            </div>
          </div>

          <div class="d-flex justify-content-between align-items-center mb-3">
            <div class="form-check">
              <input class="form-check-input" type="checkbox" value="1" id="remember" name="remember">
              <label class="form-check-label" for="remember">
                Lembrar-me
              </label>
            </div>
            <!-- Link de recuperação de senha comentado para não causar erro -->
            <!-- <a href="{{ url_for('auth.recuperar_senha') }}">Esqueci minha senha</a> -->
          </div>

          <button class="btn btn-success w-100" type="submit">
            <i class="fa-solid fa-right-to-bracket me-1"></i> Entrar
          </button>
        </form>

        <small class="text-muted d-block mt-3">
          O usuário inicial deve ser criado manualmente no banco de dados.
        </small>
      </div>
    </div>
  </div>
</div>
{% endblock %}